<link rel="import" href="../polymer/polymer-element.html">

<link rel="import" href="../iron-ajax/iron-ajax.html">

<dom-module id="detail-table">
  <template>
    <style>
      :host {
        display: block;
      }

      table {
        border-collapse: collapse;
        width: 100%;
      }

      th, td {
        padding: 8px;
        text-align: left;
        border-bottom: 1px solid #ddd;
      }

      tr:hover {background-color: #f5f5f5;}
    </style>
    <iron-ajax id="getData"
      method="{{method}}"
      handle-as="json"
      on-response="serverSuccessCb"
      last-response="{{serverSuccessObj}}"
      on-error="serverErrorCb"
      last-error="{{serverErrorObj}}"
      url="{{url}}">
    </iron-ajax>
    <div class="container">
      <table>
        <thead>
          <tr>
            <th>#</th>
            <th>Alias</th>
            <th>Amount</th>
            <th>Status</th>
            <th>Properties</th>
          </tr>
        </thead>
        <tbody>
          <template is="dom-repeat" items="{{serverSuccessObj}}"> 
            <tr>
              <td>[[item.id]]</td>
              <td>[[item.alias]]</td>
              <td>[[item.amount]]</td>
              <td>[[item.status]]</td>
              <td>[[item.properties]]</td>
            </tr>
          </template>
        </tbody>
      </table>
    </div>
  </template>

  <script>
    /**
     * `detail-table`
     * 
     *
     * @customElement
     * @polymer
     * @demo demo/index.html
     */
    class DetailTable extends Polymer.Element {
      static get is() { return 'detail-table'; }
      static get properties() {
        return {
          serverSuccessObj: {
            type: Object,
          },
          url: {
            type: String,
          },
          method: {
            type: String,
          }
        };
      }

      connectedCallback() {
        super.connectedCallback();
        this.url = "http://localhost:3000/player/";
        this.method = "GET";
        this.$.getData.generateRequest();
      }

      serverSuccessCb(e) {
        console.log(this.serverSuccessObj);
      }

      _handleSort(e) {
        let column = e.model.column;
        if (column.sorttable) {
          column.set('sortDirection', column.sortDirection === 'asc' ? 'des' : 'asc');
          column.set('sorted', true);
        }
      }
    }

    window.customElements.define(DetailTable.is, DetailTable);
  </script>
</dom-module>
